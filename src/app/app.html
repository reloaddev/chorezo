<main class="flex flex-1 flex-col p-4 items-center">
  <h1 class="text-xl">Rug√•rdsvej 16</h1>
  <h2 class="text-3xl font-bold mb-8">Chorezo</h2>

  @if (!user()) {
    <form class="w-full max-w-sm space-y-2" (submit)="login($event)">
      <label class="block">
        <span class="text-sm">Email</span>
        <input class="border p-2 w-full" type="email" required [ngModel]="email()" name="email" (ngModelChange)="email.set($event)" />
      </label>
      <label class="block">
        <span class="text-sm">Password</span>
        <input class="border p-2 w-full" type="password" required [ngModel]="password()" name="password" (ngModelChange)="password.set($event)" />
      </label>
      @if (authError()) {
        <div class="text-red-600 text-sm">{{ authError() }}</div>
      }
      <button class="bg-blue-600 text-white px-4 py-2 rounded" type="submit">Sign in</button>
    </form>
  } @else {
    <div class="self-stretch flex justify-between items-center w-full max-w-sm mb-4">
      <div class="text-sm text-gray-600">Signed in as {{ user()?.email }}</div>
      <button class="text-sm underline" (click)="logout()">Sign out</button>
    </div>

    <!-- ADDED: Minimal notification UI -->
    @if (showNotificationButton()) {
      <button class="bg-green-600 text-white px-4 py-2 rounded mb-4 text-sm" (click)="enableNotifications()">
        üîî Enable Notifications
      </button>
    }
    
    @if (showInstallPrompt()) {
      <div class="bg-blue-50 border border-blue-200 rounded p-3 mb-4 text-sm max-w-sm">
        <div class="font-semibold mb-2">üì± For iPhone notifications:</div>
        <div class="text-xs text-gray-700">
          1. Tap Share ‚¨ÜÔ∏è ‚Üí "Add to Home Screen"<br>
          2. Open app from home screen<br>
          3. Enable notifications
        </div>
        <button class="text-blue-600 underline text-xs mt-2" (click)="showInstallPrompt.set(false)">Got it</button>
      </div>
    }

    @if (isNotificationsEnabled()) {
      <div class="text-green-600 text-xs mb-4">‚úÖ Notifications enabled</div>
    }
    <!-- END: Notification UI -->

    @if (selectedTab() === 0) {
      @for (task of (tasks() ?? []); track task.type) {
        <app-task class="self-stretch w-full" [type]="task.type" [assignee]="task.assignee" [lastDone]="task.completedAt"></app-task>
      }
    } @else if (selectedTab() === 1) {
      <app-shopping-list class="w-full max-w-lg" />
    }
  }
</main>


<nav class="fixed bottom-0 left-0 w-full bg-white border-t shadow-lg flex justify-around items-center h-16 z-10">
  <button
    class="flex-1 py-2 flex flex-col items-center justify-center text-sm transition-colors duration-150 focus:outline-none"
    [class.font-bold]="selectedTab() === 0"
    [class.text-blue-600]="selectedTab() === 0"
    [class.text-gray-500]="selectedTab() !== 0"
    (click)="selectTab(0)"
  >
    <span class="text-xl mb-1" aria-hidden="true">üßπ</span>
    <span>Tasks</span>
  </button>
  <button
    class="flex-1 py-2 flex flex-col items-center justify-center text-sm transition-colors duration-150 focus:outline-none"
    [class.font-bold]="selectedTab() === 1"
    [class.text-blue-600]="selectedTab() === 1"
    [class.text-gray-500]="selectedTab() !== 1"
    (click)="selectTab(1)"
  >
    <span class="text-xl mb-1" aria-hidden="true">üõí</span>
    <span>Shopping List</span>
  </button>
</nav>

<router-outlet />
